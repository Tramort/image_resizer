{% extends "app/layout.html" %}

{% block scripts %}
    {% load staticfiles %}
    <script src="{% static 'app/scripts/script.js' %}"></script>
{% endblock %}

{% block content %}

<div class="jumbotron">
    <h1>Image Resizer</h1>
    <p class="lead">Decreasing image size by two times.</p>
</div>

<form action="/api/tasks/" method="post" enctype="multipart/form-data" id="img-upload-form">
    {% csrf_token %}
    <p>{{ form.as_table }}</p>
    <input type="submit" value="Upload">
</form>
{% verbatim  %}
<script id="taskTmpl"  type="text/template">
    <tr>
        <td>
            {{id}}
        </td>
        <td>
            {{receive_time}}
        </td>
        <td>
            <a href="{{image}}"><img src="{{image}}"/></a>
        </td>
        <td>
            {{converted_time}}
        </td>
        <td>
            <a href="{{resized_image}}"><img src="{{resized_image}}"/></a>
        </td>
    </tr>
</script>
{% endverbatim %}


{% if tasks %}
    <table id="taskTable">
    {% for task in tasks %}
        <tr>
            <td>
                {{ task.id }}
            </td>
            <td>
                {{ task.receive_time }}
            </td>
            <td>
                <a href="{{ task.image.url }}"><img src="{{ task.image.url }}"/></a>
            </td>
            <td>
                {% if task.converted_time %}
                {{ task.converted_time }}
                {% endif %}
            </td>
            <td>
                {% if task.resized_image %}
                <a href="{{ task.resized_image.url }}"><img src="{{ task.resized_image.url }}"/></a>
                {% endif %}
            </td>
        </tr>
    {% endfor%}
    </table>
{% endif %}

{% endblock %}
